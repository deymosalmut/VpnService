–û—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ ‚Äî —ç—Ç–æ **–æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è devmenu**, –≤–∏–¥–Ω–æ, —á—Ç–æ —Ç—ã —É–∂–µ –º—ã—Å–ª–∏—à—å –∫–∞–∫ ops-–∏–Ω–∂–µ–Ω–µ—Ä. –Ø —Ä–∞–∑–±–µ—Ä—É —Ñ–∞–π–ª **–ø–æ —Å—É—â–µ—Å—Ç–≤—É**, —É–∫–∞–∂—É **—á—Ç–æ —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ**, **–≥–¥–µ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏**, –∏ –¥–∞–º **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–∫–∏**, –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.

–Ø –æ–ø–∏—Ä–∞—é—Å—å –Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª .

---

## –ß—Ç–æ –£–ñ–ï —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–≤–∞–∂–Ω–æ —ç—Ç–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å)

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ devmenu ‚Äî ‚úî –ø—Ä–∞–≤–∏–ª—å–Ω–æ

* `set -Eeuo pipefail` ‚Äî –æ—Ç–ª–∏—á–Ω–æ
* `REPO_ROOT` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
* `reports/` –≤–Ω—É—Ç—Ä–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Äî ‚úî
* –æ—Ç—á—ë—Ç—ã **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, timestamped**
* `cleanup_reports_keep_last` ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
* `git add -f` ‚Äî –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, üëç
* API lifecycle (bg / fg / stop) ‚Äî **–ª—É—á—à–µ, —á–µ–º —É 90% MVP**
* –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ private key –≤ `wg show dump` ‚Äî ‚úî –∫—Ä–∏—Ç–∏—á–Ω–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

–ü–æ —Å—É—Ç–∏: **—ç—Ç–æ —É–∂–µ production-grade devmenu**, –∞ –Ω–µ ‚Äú—Å–∫—Ä–∏–ø—Ç‚Äù.

---

## –ö–†–ò–¢–ò–ß–ù–´–ï –∑–∞–º–µ—á–∞–Ω–∏—è (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

### ‚ùå 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ ‚ÄúFull audit‚Äù

–£ —Ç–µ–±—è **–µ—Å—Ç—å –¥–≤–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞**:

* —Ñ—É–Ω–∫—Ü–∏—è `run_full_audit()`
* –∏ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥** –≤ `case 1)`

–≠—Ç–æ –æ–ø–∞—Å–Ω–æ:

* –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –≤–Ω–æ—Å–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ –º–µ—Å—Ç–æ –∏ –∑–∞–±—ã–≤–∞—Ç—å—Å—è –≤ –¥—Ä—É–≥–æ–º
* –ø–æ—è–≤–∏—Ç—Å—è —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω –æ—Ç—á—ë—Ç–æ–≤

### ‚úÖ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–û—Å—Ç–∞–≤–∏—Ç—å –¢–û–õ–¨–ö–û `run_full_audit()`**, –∞ –≤ `case 1)` –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞—Ç—å –µ—ë.

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)

–ó–∞–º–µ–Ω–∏—Ç—å `case 1)` –Ω–∞:

```bash
1)
  run_full_audit
  ;;
```

–ê –≤ `run_full_audit()`:

* –¥–æ–±–∞–≤–∏—Ç—å cleanup + push (–∫–∞–∫ —Ç—ã —É–∂–µ —Å–¥–µ–ª–∞–ª –≤ `case 1`)

–≠—Ç–æ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä**, –∏–Ω–∞—á–µ –¥–∞–ª—å—à–µ –±—É–¥–µ—Ç –±–æ–ª—å.

---

## –í–ê–ñ–ù–´–ï, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### ‚ö†Ô∏è 2. `api_start_bg`: port check –∂—ë—Å—Ç–∫–æ –Ω–∞ `5272`

–¢—ã –ø—Ä–æ–≤–µ—Ä—è–µ—à—å –ø–æ—Ä—Ç —Ç–∞–∫:

```bash
ss -ltnp | grep -q ":5272"
```

–ù–æ –ø—Ä–∏ —ç—Ç–æ–º —É —Ç–µ–±—è –µ—Å—Ç—å:

```bash
export API_URL="${API_URL:-http://localhost:5272}"
```

–ï—Å–ª–∏ –∑–∞–≤—Ç—Ä–∞ –ø–æ—Ä—Ç –ø–æ–º–µ–Ω—è–µ—Ç—Å—è ‚Äî –ª–æ–≥–∏–∫–∞ —Å–ª–æ–º–∞–µ—Ç—Å—è.

### ‚úÖ –ü—Ä–∞–≤–∫–∞

–î–æ–±–∞–≤—å:

```bash
API_PORT="${API_PORT:-${API_URL##*:}}"
```

–ò –∏—Å–ø–æ–ª—å–∑—É–π:

```bash
grep -q ":$API_PORT"
```

---

### ‚ö†Ô∏è 3. `cleanup_reports_keep_last` —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ git-—Å—Ç–∞—Ç—É—Å–∞

–°–µ–π—á–∞—Å:

* –µ—Å–ª–∏ repo –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ
* –∏–ª–∏ –µ—Å—Ç—å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  ‚Üí cleanup –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–π–¥—ë—Ç

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–µ–π—á–∞—Å)

–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É:

```bash
git diff --quiet || {
  echo "Cleanup aborted: working tree is dirty"
  return 1
}
```

---

### ‚ö†Ô∏è 4. `REPORT_GIT_COMMIT` vs auto-push –ª–æ–≥–∏–∫–∞

–£ —Ç–µ–±—è —Å–µ–π—á–∞—Å:

* –µ—Å—Ç—å `REPORT_GIT_COMMIT`
* –Ω–æ **–ø—É–Ω–∫—Ç 1 –≤—Å–µ–≥–¥–∞ –∫–æ–º–º–∏—Ç–∏—Ç –∏ –ø—É—à–∏—Ç**, –∏–≥–Ω–æ—Ä–∏—Ä—É—è —Ñ–ª–∞–≥

–≠—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ**, –Ω–æ:

* –ª–∏–±–æ —É–±–µ—Ä–∏ `REPORT_GIT_COMMIT` —Å–æ–≤—Å–µ–º
* –ª–∏–±–æ —Å–æ–±–ª—é–¥–∞–π –µ–≥–æ –≤–µ–∑–¥–µ

–ò–Ω–∞—á–µ —ç—Ç–æ —Å–±–∏–≤–∞–µ—Ç —Å —Ç–æ–ª–∫—É.

---

## Stage 3.2 ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (–ø–æ —Ñ–∞–∫—Ç—É)

### ‚úî –ß—Ç–æ –≥–æ—Ç–æ–≤–æ

* –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ devmenu ‚Äî ‚úî
* –±–µ–∑–æ–ø–∞—Å–Ω—ã–π WG read-only ‚Äî ‚úî
* auth + token ‚Äî ‚úî
* dry-run endpoint discovery ‚Äî ‚úî
* –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ Git ‚Äî ‚úî

