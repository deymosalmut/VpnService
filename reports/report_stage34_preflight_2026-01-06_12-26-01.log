
[1;33m>>> Stage 3.4 Preflight (A): DB app connect + migrations precheck[0m
TIME_UTC: Ð’Ñ‚ 06 ÑÐ½Ð² 2026 12:26:01 UTC
HOST: Vpn-Main
USER: root
REPO_ROOT: /opt/vpn-service
REPORT_FILE: /opt/vpn-service/reports/report_stage34_preflight_2026-01-06_12-26-01.log

API_URL: http://localhost:5272
IFACE: wg1

DB (APP) PG_HOST=127.0.0.1 PG_PORT=5432 PG_DB=vpnservice PG_USER=vpnservice PG_PASSWORD=vp***

[1;33m>>> API: health[0m
CMD: curl -fsS http://localhost:5272/health
HealthySTATUS: 0
[0;32mOK[0m API health reachable.

[1;33m>>> WG: show dump (first 5 lines)[0m
CMD: bash -lc wg show 'wg1' dump | head -n 5
oPRJJkT7yzF4bx1JuLtnKfQrQLfiJ3NhIkGUt+8Py2k=	ZYXEy5Xnr+8yTjisbjgyaLGzvDBqvPtcY6A/EFEAk0U=	51820	off
STATUS: 0

[1;33m>>> DB (system/socket): select 1[0m
CMD: sudo -u postgres psql -v ON_ERROR_STOP=1 -Atc select 1;
1
STATUS: 0
[0;32mOK[0m DB admin socket access OK.

[1;33m>>> DB (app/tcp): select 1[0m
CMD: bash -lc PGPASSWORD='vpnservice_pwd_20260106_114545' psql -h '127.0.0.1' -p '5432' -U 'vpnservice' -d 'vpnservice' -v ON_ERROR_STOP=1 -Atc 'select 1;'
1
STATUS: 0
[0;32mOK[0m DB app connection OK.

[1;33m>>> dotnet: info (top)[0m
CMD: bash -lc dotnet --info | sed -n '1,25p'
ÐŸÐÐšÐ•Ð¢ SDK Ð”Ð›Ð¯ .NET:
 Version:           9.0.203
 Commit:            dc7acfa194
 Workload version:  9.0.200-manifests.9df47798
 MSBuild version:   17.13.20+a4ef1e90f

Ð¡Ñ€ÐµÐ´Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ:
 OS Name:     ubuntu
 OS Version:  24.04
 OS Platform: Linux
 RID:         linux-x64
 Base Path:   /usr/share/dotnet/sdk/9.0.203/

Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ .NET:
ÐÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ñ… Ð½Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº Ð´Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ.
ÐÐ°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¾ Ð½Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ loose manifests Ð¿Ñ€Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ Ð½Ð¾Ð²Ñ‹Ñ… Ð¼Ð°Ð½Ð¸Ñ„ÐµÑÑ‚Ð¾Ð².

Host:
  Version:      9.0.4
  Architecture: x64
  Commit:       f57e6dc747

.NET SDKs installed:
  8.0.416 [/usr/share/dotnet/sdk]
  9.0.203 [/usr/share/dotnet/sdk]
STATUS: 0
[0;31mFAIL[0m dotnet-ef not found (install if you plan to run migrations from CLI).

[1;33m>>> Summary[0m
[0;32mOK[0m Stage 3.4 preflight PASSED.
