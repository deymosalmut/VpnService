----------------------------------------------------------------
>>> Stage 3.5 â€” DB DOCTOR: public."VpnPeers" (read-only)
----------------------------------------------------------------
----------------------------------------------------------------
>>> Load app DB env
----------------------------------------------------------------
+ CMD: bash -lc 
    cd '/opt/vpn-service'
    source scripts/lib/appdb.sh
    load_app_db_env '/opt/vpn-service/infra/local/app-db.env'
    echo "PG_DATABASE=$PG_DATABASE PG_USER=$PG_USER PG_HOST=$PG_HOST PG_PORT=$PG_PORT PG_PASSWORD=${PG_PASSWORD:+SET}"
  
PG_DATABASE=vpnservice PG_USER=vpnservice PG_HOST=127.0.0.1 PG_PORT=5432 PG_PASSWORD=SET
STATUS: OK (exit=0)
----------------------------------------------------------------
>>> Columns (name|type|nullable|default)
----------------------------------------------------------------
+ CMD: bash -lc 
    cd '/opt/vpn-service'
    source scripts/lib/appdb.sh
    load_app_db_env '/opt/vpn-service/infra/local/app-db.env'
    psql_app -Atc "
      select column_name||'|'||data_type||'|'||is_nullable||'|'||coalesce(column_default,'')
      from information_schema.columns
      where table_schema='public' and table_name='VpnPeers'
      order by ordinal_position;
    "
  
Id|uuid|NO|
PublicKey|character varying|NO|
AssignedIp|character varying|NO|
Status|integer|NO|
CreatedAt|timestamp with time zone|NO|CURRENT_TIMESTAMP
UpdatedAt|timestamp with time zone|YES|
VpnServerId|uuid|NO|
STATUS: OK (exit=0)
----------------------------------------------------------------
>>> Row count
----------------------------------------------------------------
+ CMD: bash -lc 
    cd '/opt/vpn-service'
    source scripts/lib/appdb.sh
    load_app_db_env '/opt/vpn-service/infra/local/app-db.env'
    psql_app -Atc 'select count(*) from public."VpnPeers";'
  
1
STATUS: OK (exit=0)
----------------------------------------------------------------
>>> Sample rows (top 20): Id|PublicKey|AssignedIp|Status|VpnServerId|CreatedAt|UpdatedAt
----------------------------------------------------------------
+ CMD: bash -lc 
    cd '/opt/vpn-service'
    source scripts/lib/appdb.sh
    load_app_db_env '/opt/vpn-service/infra/local/app-db.env'
    psql_app -Atc "
      select
        \"Id\"::text||'|'||
        \"PublicKey\"||'|'||
        coalesce(\"AssignedIp\",'')||'|'||
        \"Status\"::text||'|'||
        \"VpnServerId\"::text||'|'||
        \"CreatedAt\"::text||'|'||
        coalesce(\"UpdatedAt\"::text,'')
      from public.\"VpnPeers\"
      order by \"CreatedAt\" desc
      limit 20;
    "
  
1f32ef1f-1c20-4b64-9aa9-ca103c3eaf0a|QJh6h5iG80A3kvfmP46RvSR1ddBDOWV+6lMU04tNUBY|10.8.0.100|1|01a9e169-2e7c-4e76-8272-0469d175b0f3|2026-01-06 15:06:29.038433+00|
STATUS: OK (exit=0)
----------------------------------------------------------------
>>> DONE
----------------------------------------------------------------
